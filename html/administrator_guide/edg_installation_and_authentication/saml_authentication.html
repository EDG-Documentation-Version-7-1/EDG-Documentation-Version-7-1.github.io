<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SAML Authentication &mdash; edg-documentation 7.2 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/./_css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
        <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="OAuth Authentication" href="oauth_authentication.html" />
    <link rel="prev" title="LDAP Configuration" href="ldap_configuration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html">
            <img src="../../_static/EDG-logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction to EDG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick_start_guides/index.html">Quick Start Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrading_topbraid_edg/index.html">Upgrades and Migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installing_sample_data/index.html">Installing Sample Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administrator Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation_checklist/index.html">Installation Checklist</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">EDG Installation and Authentication</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="edg_server_platform_considerations.html">EDG Server Platform Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="authentication_edg_background.html">Authentication for TopBraid EDG</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldap_configuration.html">LDAP Configuration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">SAML Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#context-xml-changes">Context.xml Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#debugging">Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="oauth_authentication.html">OAuth Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="tomcat_users_authentication.html">Tomcat Users Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="edg_server_installation.html">EDG Server Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="edg_server_installation.html#edg-installation-using-the-setup-properties-file">EDG installation using the setup.properties file</a></li>
<li class="toctree-l3"><a class="reference internal" href="edg_server_installation.html#edg-installation-using-the-interactive-deployment-wizard">EDG installation using the interactive deployment wizard</a></li>
<li class="toctree-l3"><a class="reference internal" href="database_type_app_data_storage.html">Database Type: Application data storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="configure_logging.html">Configure Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="accessing_edg_application.html">Accessing the EDG Application</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edg_administration_and_configuration/index.html">EDG Administration and Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topbraid_data_platform/index.html">TopBraid Data Platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_classifier_installation/index.html">Auto Classifier Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topbraid_explorer_setup/index.html">TopBraid Explorer Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edg_backup_and_restore/index.html">EDG Backup and Restore</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../topbraid_edg_studio/index.html">TopBraid EDG Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graphql/index.html">GraphQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripting/index.html">Scripting with JavaScript and ADS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ext/index.html">Extension Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs/index.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/index.html">TopQuadrant EDG Support</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">edg-documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Administrator Guide</a> &raquo;</li>
          <li><a href="index.html">EDG Installation and Authentication</a> &raquo;</li>
      <li>SAML Authentication</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="saml-authentication">
<span id="id1"></span><h1>SAML Authentication<a class="headerlink" href="#saml-authentication" title="Permalink to this headline"></a></h1>
<p>This section describes how to use the EDG server with SAML authentication.
When choosing this method of authentication, be sure that you have a technical resource familiar with your Identity Provider to assist with configuration.
TopQuadrant is unable to assist with specific configuration options for each customers Identity Provider.</p>
<p>The TopBraid SAML valve supports SP-Initiated Browser based SAML 2.0 Single Sign On (SSO).
HTTPS is required to be used by the Tomcat instance and the Tomcat will need to be supplied the certificates of the IDP to allow trusted HTTP communication.
Likewise, the IDP will need to have the certificates of the Tomcat instance.
<strong>The TopBraid SAML valve requires at least 2 attributes from the IDP, one to be mapped to the user object and one to be mapped to the role object.</strong>
While the valve is also capable of detecting authorization headers – ie: basic auth included, those are routed to the authentication providers of the VM, eg: JNDI LDAP and/or local tomcat-users.xml.</p>
<p>If a BASIC authorization header is missing, then the valve will proceed to the IDP login process.</p>
<ul class="simple">
<li><p>SAML will only work with secure connections (HTTPS).</p></li>
<li><p><strong>API clients will need to use BASIC or OAuth if they want to use SAML for Browser SSO.
You cannot authenticate using a SAML SSO user for APIs (including send projects to another server and publish to Explorer)</strong></p></li>
<li><p>API clients will need to connect to EDG using HTTPS if EDG is using SAML.</p></li>
<li><p>Any SPARQLMotion modules that use URLs to connect to EDG will need to use HTTPS if EDG is using SAML.</p></li>
</ul>
<p>The valve consists of the following (provided in the zip file that also contains the edg.war):</p>
<ul class="simple">
<li><p>SAML valve jar and dependencies</p></li>
<li><p>modified context.xml</p></li>
</ul>
<p>Place the Auth jars from TopBraid-Auth.zip (available from the EDG download page) in the lib directory of your Tomcat instance.</p>
<p>Place the context.xml in your webapp/edg/META-INF directory. It is a good idea to backup the original context.xml</p>
<section id="context-xml-changes">
<h2>Context.xml Changes<a class="headerlink" href="#context-xml-changes" title="Permalink to this headline"></a></h2>
<p>In the webapps/edg/META-INF directory, you can find an ADFS file that is a template to use for most SAML configurations (just change IDP, SP and attribute mappings.)</p>
<ol class="arabic simple">
<li><p>Modify the context.xml to match the path to your IDP Federated Metadata URL.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>The path to the metadata xml can be either <a class="reference external" href="file:///">file:///</a> or <a class="reference external" href="http://">http://</a> paths.</p></li>
<li><p><a class="reference external" href="file:///">file:///</a> paths should be absolute filesystem paths.</p></li>
<li><p>if there is latency to the <a class="reference external" href="http://">http://</a> path, the xml can be downloaded to the local filesystem to improve performance.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Modify the context.xml to match the attribute mappings sent by your IDP to the username and role fields used by EDG.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Map username/login ID URI =&gt;name     * required</p></li>
<li><p>Map group or role URI =&gt;role      * <strong>required</strong> for RBAC</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Additional attributes can be added for email address and display name.
These will then be used in EDG’s user directory:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Map email URI =&gt;http://edg.topbraid.solutions/model/email</p></li>
<li><p>Map display name URI=&gt;http://edg.topbraid.solutions/model/name</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Define the Service Provider</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>When defining the Service Provider in the IDP, the assertion consumer URL (Entity ID) will be <a class="reference external" href="http://yourserver/edg/saml">http://yourserver/edg/saml</a></p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Timeout</p></li>
</ol>
<blockquote>
<div><ul>
<li><p>An appropriate SSO session timeout will be determined from the assertion sent from the IDP, if possible.
Alternately, you can configure sessionTimeout (in minutes) in context.xml</p>
<p>sessionTimeout=90</p>
</li>
</ul>
</div></blockquote>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline"></a></h2>
<p>If you need to debug the SAML Response or assertion attributes, you can place the following at the end of your logging.properties file in Tomcat and restart Tomcat.
java.util.logging.ConsoleHandler.level = FINEST
org.topbraidlive.auth.adapters.saml.tomcat.level = FINEST</p>
<p>This will give the entire SAML response and attributes in the catalina log file.</p>
<p>Detailed instructions are provided upon request to <a class="reference external" href="mailto:support&#37;&#52;&#48;topquadrant&#46;com">support<span>&#64;</span>topquadrant<span>&#46;</span>com</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ldap_configuration.html" class="btn btn-neutral float-left" title="LDAP Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="oauth_authentication.html" class="btn btn-neutral float-right" title="OAuth Authentication" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, TopQuadrant, Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>